(function(){var h,e,m,n=[].slice;this.ns=function(a){var b,c,d,k;b=a.split(".");a=window[b[0]];void 0===a&&(a=window[b[0]]={});c=b.slice(1);d=0;for(k=c.length;d<k;d++)b=c[d],a=a[b]=a[b]||{};return a};this.ultimello={};this.ultimello.utils={ns:this.ns,mixin:function(a,b){for(var c in b)a[c]=b[c];return a},toArray:function(a){var b;b=a;a.constructor!==Array&&(b=[a]);return b},getBufferedFn:function(a,b){var c,d;d=null;c=function(){d=null;return a.apply(this,arguments)};return function(){var a;a=1<=
arguments.length?n.call(arguments,0):[];null!=d&&(clearTimeout(d),d=null);return d=setTimeout(function(){return c.apply(this,a)},b)}},wait_for:function(a,b){var c,d,k,f,g,e;f=a.predicate;d=a.interval;g=a.timeout;c=e=!1;g&&setTimeout(function(){return e=!0},g);return k=setInterval(function(){var a;if(((a=f())||e)&&!c)return c=!0,clearInterval(k),b(a)},d)},mutationRecordsHasElement:function(a,b){var c=this;return a.some(function(a){return c.mutationRecordHasElement(a,b)})},mutationRecordHasElement:function(a,
b){return["addedNodes","removedNodes"].some(function(c){return $.makeArray(a[c]).some(function(a){return $(a).hasClass(b)})})},orderElementsAsInList:function(a,b){var c,d,e,f,g,h,l;f=[];l=a.slice(0,-1);d=g=0;for(h=l.length;g<h;d=++g)c=l[d],c=b(c),e=b(a[d+1]),c&&e&&($(e).insertAfter(c),f[d]=c,f[d+1]=e);return f},getCardShortIdAndUrlFromEl:function(a){var b;b=$(a).find(".js-card-name");a=b.attr("href");b.length&&a?(b=+a.split("/").last().split("-")[0],a="https://trello.com/c/"+a.split("/")[2]):a=b=
null;return{shortId:b,shortUrl:a}},parseTrelloUrl:function(a){var b,c;c=a.replace("//","/").split("/");b=c[2];a=c[3];5<=c.length&&n.call(c,4);a:switch(b){case "c":b="trello-card-opened";break a;default:b=null}return{state:b,cardShortLink:a}},openTab:function(a){return chrome.tabs.create({url:chrome.extension.getURL(a)})},autoBindAll:function(a){for(var b in a)R.is(Function,a[b])&&(a[b]=a[b].bind(a));return a}};ultimello.utils.ns("ultimello.utils");ultimello.utils.storage={load:function(a){a=localStorage[this._key(a)];
return null!=a?JSON.parse(a):null},save:function(a,b){var c;c=this._key(a);return null==b?delete localStorage[c]:localStorage[c]=JSON.stringify(b)},_key:function(a){return"ultimello_"+a}};e=ultimello.utils;h={storage:e.storage};chrome.runtime.onMessage.addListener(function(a,b,c){b=h[a.facility];a=null!=b?b[a.method].apply(b,a.params||[]):null;return c(a)});chrome.browserAction.onClicked.addListener(function(a){return e.openTab("settings.html")});!e.storage.load("installed-version")&&e.openTab("settings.html");
m=chrome.runtime.getManifest().version;e.storage.save("installed-version",m)}).call(this);
