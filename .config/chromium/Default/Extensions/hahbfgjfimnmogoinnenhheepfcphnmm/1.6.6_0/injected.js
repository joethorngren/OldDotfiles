(function(){var h=[].slice;(function(){var g,d,f,e;f=WebSocket;window.WebSocket=function(a,b){var c=this;this.ws=new f(a,b);this.send=function(){return c.ws.send.apply(c.ws,arguments)};this.close=function(){return c.ws.close.apply(c.ws,arguments)};this.ws.onmessage=function(b){var a;null!=(a=c.onmessage)&&a.apply(c.ws,arguments);return setTimeout(function(){var a;a=new CustomEvent("trello-data-received",{detail:{data:b.data,url:b.currentTarget.url}});return window.dispatchEvent(a)},50)};this.ws.onopen=
function(){var a;return null!=(a=c.onopen)?a.apply(c.ws,arguments):void 0};return this};g=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(a,b,c,d,f){var e=this;g.apply(this,arguments);return setTimeout(function(){return e.addEventListener("readystatechange",function(){var a;if(4===this.readyState&&200===this.status)return a=new CustomEvent("trello-data-received",{detail:{data:this.response,url:b}}),window.dispatchEvent(a)},!1)},5)};d=function(){var a,b;b=e(window.location.href);
a=b.action_type;b=b.entityShortUrl;if(a)return a=new CustomEvent(a,{detail:{data:{entityShortUrl:b},url:window.location.href}}),window.dispatchEvent(a)};e=function(a){var b,c;c=a.replace("//","/").split("/");b=c[2];a=c[3];5<=c.length&&h.call(c,4);a:switch(b){case "c":b="trello-card-opened";break a;default:b=null}return{action_type:b,entityShortUrl:a}};d();return function(a){return function(b){return history.pushState=function(){b.apply(this,arguments);return a.apply(window,arguments)}}(history.pushState)}(d)})()}).call(this);
